container: maven:3-jdk-8

variables:
  CI_PROJECT_PATH: "ReightI/test-nucleusj-ci-cd"
  API_IMAGE_NAME: $CI_REGISTRY_IMAGE:$CI_COMMIT_REF_NAME
  VERSION: "2.0.1"

# ------------------------- Compile ----------------------------------------
# Compile the Maven project with all it's dependencies thanks to maven-assembly-plugin.


jobs:
  compile:
  runs-on : ubuntu-latest
  steps :
      run: mvn versions:set -DnewVersion=$VERSION
            - mvn clean package
      -name: target
        uses: {% data reusables.actions.action-upload-artifact %}
        with:
          name: target
          path: target

# ------------------------- Deploy ----------------------------------------
# Deploy the Maven artifacts generated by "Compile" stage to Gitlab Maven repository.

  deploy:
  runs-on : ubuntu-latest
  
